# nixpacks.toml

[phases.setup]
# 1. Install Node 20 (Prisma 7 requirement)
nixPkgs = ["nodejs-20_x"]

# 2. Manually force install pnpm using npm
# This fixes "pnpm: command not found" by ensuring the binary is installed globally
cmds = ["npm install -g pnpm@9"]

[phases.install]
# 3. Install dependencies using the pnpm we just installed
dependsOn = ["setup"]
cmds = ["pnpm install"]

[phases.build]
# 4. Build the app
dependsOn = ["install"]
cmds = ["pnpm build"]

[start]
cmd = "pnpm start"