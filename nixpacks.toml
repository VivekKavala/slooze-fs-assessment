# nixpacks.toml

[phases.setup]
# Let Nixpacks install Node.js automatically based on package.json engines.
# We only explicitly add system libraries needed for Prisma/Database.
# We add 'pnpm' here if it's available in the default channel.
nixPkgs = ["openssl", "pnpm"]

# If pnpm isn't in the default nix channel, we force it via npm
# This runs AFTER nixPkgs are installed
cmds = ["npm install -g pnpm@9"]

[phases.install]
dependsOn = ["setup"]
cmds = ["pnpm install"]

[phases.build]
dependsOn = ["install"]
cmds = ["pnpm build"]

[start]
cmd = "pnpm start"