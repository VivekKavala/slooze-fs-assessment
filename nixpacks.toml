# nixpacks.toml

[phases.setup]
# 1. Install Node 20 and OpenSSL (Required for Prisma)
nixPkgs = ["nodejs-20_x", "openssl"]

# 2. Use Corepack to enable pnpm (Native Node feature)
# This is more reliable than npm install -g in Nixpacks
cmds = ["corepack enable pnpm"]

[phases.install]
dependsOn = ["setup"]
cmds = ["pnpm install"]

[phases.build]
dependsOn = ["install"]
# 3. Prisma generate is crucial before build
cmds = ["pnpm build"]

[start]
cmd = "pnpm start"